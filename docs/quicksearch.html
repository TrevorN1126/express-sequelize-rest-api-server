<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"modules.list.html":{"id":"modules.list.html","title":"Modules","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Modules Classes APIError AuthService DbService ExtendableError ThingService UserService × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Classes Classes APIError AuthService DbService ExtendableError ThingService UserService × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Express Rest API Server Boilerplate Overview This is a boilerplate application for building REST APIs with Express, Mongoose, permission based JWT Authentication and Mocha tests. Created with attempting to follow Node.js Best Practices as closely as possible. Features Feature Summary Authentication via JsonWebToken Supports authentication using jsonwebtoken. Code Linting JavaScript code linting is done using ESLint - a pluggable linter tool for identifying and reporting on patterns in JavaScript. Uses ESLint with eslint-config-airbnb, which tries to follow the Airbnb JavaScript style guide. Auto server restart Restart the server using nodemon in real-time anytime an edit is made, with babel compilation and eslint. Debugging via debug Instead of inserting and deleting console.log you can replace it with the debug function and just leave it there. You can then selectively debug portions of your code by setting DEBUG env variable. If DEBUG env variable is not set, nothing is displayed to the console. API parameter validation via express-validation Validate body, params, query, headers and cookies of a request (via middleware) and return a response with errors; if any of the configured validation rules fail. You won't anymore need to make your route handler dirty with such validations. Pre-commit hooks Runs lint and tests before any commit is made locally, making sure that only tested and quality code is committed Secure app via helmet Helmet helps secure Express apps by setting various HTTP headers. Uses yarn over npm Uses new released yarn package manager by facebook. You can read more about it here CORS support via cors fasdfasdfasdfdsdasfsdfasdfasdfasdf Uses http-status to set http status codes fasdfasdfasdfdsdasfsdfasdfasdfasdf Generated documentation using jsdocs fasdfasdfasdfdsdasfsdfasdfasdfasdf Has .editorconfig which helps developers define and maintain consistent coding styles between different editors and IDEs. Uses mocha Getting Started Clone the repo: git clone https://github.com/TrevorN1126/express-sequelize-rest-api-server.git cd express-sequelize-rest-api-server Install yarn: npm install -g yarn Install dependencies: yarn Set environment (vars): cp .env.example .env Make sure the database server is running and the databases defined in config/database.json are already created Create db tables npx sequelize-cli db:migrate Seed db tables npx sequelize-cli db:seed:all Start server: # Start server yarn start # start server with nodemon yarn start-dev # Selectively set DEBUG env var to get logs DEBUG=express-sequelize-rest-api-server:* yarn start Refer debug to know how to selectively turn on logs. Tests: # Run tests written in ES6 yarn test # Run tests on file change yarn test:watch # Run test coverage yarn test:coverage Lint: # Lint code with ESLint yarn lint # Run lint on any file change yarn lint:watch Deployment # compile to ES5 1. yarn build # upload dist/ to your server 2. scp -rp dist/ user@dest:/path # install production dependencies only 3. yarn --production Routes Protected Routes require a jwt header to access and the listed permission on the user Authorization: Bearer {token} Auth POST /api/auth/login - Returns token if correct username and password is provided GET /api/auth/random-number - Example route that return a random number protected route (no permission required) User GET /api/users - Get list of users protected route (admin permission required) POST /api/users - Create new user protected route (admin permission required) GET /api/users/:userId - Get user protected route (admin permission required) PUT /api/users/:userId - Update user protected route (admin permission required) DELETE /api/users/:userId - Delete user protected route (admin permission required) Thing GET /api/things - Get list of things public route (no permission required) POST /api/things - Create new thing protected route (admin or user permission required) GET /api/things/:thingId - Get thing public route (no permission required) PUT /api/things/:thingId - Update thing protected route (admin permission required) DELETE /api/things/:thingId - Delete thing protected route (admin permission required) Project Structure Layered Component based Folders under the /server directory are organized into self-contained components that don't share files with others, each constitutes very few files (e.g. models, routes, controllers, services, test, etc.) so that it's very easy to reason about it. This not only draws a clean separation of concerns but also significantly eases mocking and testing the system. *.route.js : Uses an express.Router() to define the endpoint, register middleware and then calls the component controller *.controller.js : Sets up any req variables, then calls the services and handles the res back to the route *.service.js : Handles any business logic or db calls (ideally db abstractions should be their own layer and then called by the service layer) *.test.js : Defines all test for the Component ├── server/ │ ├── component/ │ ├── component.controller.js │ ├── component.route.js │ ├── component.service.js │ ├── tests/ │ ├── component.route.test.js │ ├── component.service.test.js └── Logging Universal logging library winston is used for logging. It has support for multiple transports. A transport is essentially a storage device for your logs. Each instance of a winston logger can have multiple transports configured at different levels. For example, one may want error logs to be stored in a persistent remote location (like a database), but all logs output to the console or a local file. We just log to the console for simplicity, you can configure more transports as per your requirement. API logging Logs detailed info about each api request to console during development. Error logging Logs stacktrace of error to console along with other details. Contributing For code contributions submit a pull request along with tests. License This project is licensed under the MIT License × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"APIError.html":{"id":"APIError.html","title":"Class: APIError","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Class: APIError APIError Class representing an API error. new APIError(message, status, isPublic) Creates an API error. Parameters: Name Type Default Description message string Error message. status number HTTP status code of error. isPublic boolean false Whether the message should be visible to user or not. Extends ExtendableError × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"AuthService.html":{"id":"AuthService.html","title":"Class: AuthService","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Class: AuthService AuthService Creates a new AuthService. new AuthService() × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"DbService.html":{"id":"DbService.html","title":"Class: DbService","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Class: DbService DbService Creates a new ItemService. new DbService(componentName, models) Creates a database service with basic CRUD functions Parameters: Name Type Description componentName string The name of the component being used models object All database models Methods &lt;async&gt; Create(item) Create a new item Parameters: Name Type Description item Object representing a new item Returns: item - return the item or an Error with the error message Type object | Error &lt;async&gt; GetItem(itemId) Get a item Parameters: Name Type Description itemId The _id of the item Returns: item Type object | Error &lt;async&gt; List() Get a list of all items Returns: item - An array of items Type Array.&lt;object&gt; &lt;async&gt; Remove(itemId) Update a item Parameters: Name Type Description itemId The _id of the item Returns: 1 or error - \"Item not found.\" Type number | Error &lt;async&gt; Update(itemId, item) Update a item Parameters: Name Type Description itemId The _id of the item item TThe new values for the item Returns: item Type object | Error × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"ExtendableError.html":{"id":"ExtendableError.html","title":"Class: ExtendableError","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Class: ExtendableError ExtendableError new ExtendableError() Extends Error × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"module-Auth%20Controller.html":{"id":"module-Auth%20Controller.html","title":"Module: Auth Controller","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Module: Auth Controller Controller for the auth component Methods &lt;inner&gt; getRandomNumber(req, res) This is a protected route. Will return random number only if jwt token is provided in header. Parameters: Name Type Description req res Returns: Type * &lt;async, inner&gt; login(req, res, next) Returns jwt token if username is stored in the databse and the password matches Parameters: Name Type Description req res next Returns: Type * × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"module-Auth%20Routes.html":{"id":"module-Auth%20Routes.html","title":"Module: Auth Routes","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Module: Auth Routes Routes for the /api/auth endpoints Members &lt;route&gt; Login Route: MethodPath POST /api/auth/login Login a user Body Parameters: Name Type Description req.body.username String The username of user trying to login. req.body.password String The password of user trying to login. Response: Name Type Description auth Object auth.success Boolean True if the auth request was successfull. auth.message String The message 'Authentication successfull'. auth.user Object An object containing the user's fields. auth.token String The JWT for the user. error APIError error.message APIError Authentication failed. User not found. error.message APIError Authentication failed. Invalid password. Response Code: Type Description 200 If the request is successful. 401 If Authentication failed. &lt;route&gt; Random Number Route: MethodPath GET /api/auth/random-number Get a random number Authentication This route requires a valid token with no permissions. If authentication fails it will return a 401 error. Header Parameters: Name Type Description Authorization String Requires a 'Bearer Token' with a valid token. Response: Name Type Description object Object object.num Integer Responds with a random number. Response Code: Type Description 200 If the request is successful. 401 If Authentication failed. × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"module-Thing%20Routes.html":{"id":"module-Thing%20Routes.html","title":"Module: Thing Routes","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Module: Thing Routes Routes for the /api/things endpoints Members &lt;route&gt; Create Thing Route: MethodPath POST /api/things Creates a new Thing Authentication This route requires a valid token with 'User' or 'Admin' permissions. If authentication fails it will return a 401 error. Body Parameters: Name Type Attributes Description req.body Object req.body.name String The name of the thing. req.body.description String optional The description of the thing. req.body.UserId Integer The PK of the user that this thing belongs to. Response: Name Type Description Thing object error APIError error.message APIError error.httpStatus APIError Response Code: Type Description 200 If the request is successful. 400 If body is not sent right. &lt;route&gt; Delete Thing Route: MethodPath DELETE /api/things/:thingId Delete a thing by id Authentication This route requires a token with Admin permission. If authentication fails it will return a 401 error. Route Parameters: Name Type Description :thingId String The unique identifier for the thing to delete. Response: Name Type Description Thing Object error APIError error.message APIError User not found. error.httpStatus APIError NOT_FOUND Response Code: Type Description 200 If the request is successful. 404 If the thing is not found. &lt;route&gt; Get Thing Route: MethodPath GET /api/things/:thingId Get a thing by id Route Parameters: Name Type Description :thingId String The unique identifier for the thing to get. Response: Name Type Description Thing Object error APIError error.message APIError User not found. error.httpStatus APIError NOT_FOUND Response Code: Type Description 200 If the request is successful. 404 If the thing is not found. &lt;route&gt; Thing List Route: MethodPath GET /api/things Get a list of things Response: Name Type Description Things Array.&lt;Thing&gt; An array of things Response Code: Type Description 200 If the request is successful. &lt;route&gt; Update Thing Route: MethodPath PUT /api/things/:thingId Update a thing by id Authentication This route requires a token with Admin permission. If authentication fails it will return a 401 error. Route Parameters: Name Type Description :thingId String The unique identifier for the thing to update. Response: Name Type Description Thing Object error APIError error.message APIError User not found. error.httpStatus APIError NOT_FOUND Response Code: Type Description 200 If the request is successful. 404 If the thing is not found. Type Definitions Thing Thing model Type: Object Properties: Name Type Description name string The name of the thing. description string The description of the thing. UserId integer The PK of the user this thing belongs to. × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"module-ThingController.html":{"id":"module-ThingController.html","title":"Module: ThingController","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Module: ThingController Controller for the thing component Methods &lt;async, inner&gt; create() Create new thing Parameters: Name Type Description req.body Object Properties Name Type Argument Description name String The name of a thing. description String &lt;optional&gt; The description of a thing. UserId Integer The PK of the user that this thing belongs to. Returns: Type Thing &lt;async, inner&gt; get() Get an existing thing Properties: Name Type Description req.params.thingId string The _id of thing. Returns: Type Thing &lt;async, inner&gt; list() Get thing list. Returns: Type Array.&lt;Thing&gt; &lt;async, inner&gt; remove() Delete thing. Returns: Type Thing &lt;async, inner&gt; update() Update existing thing Properties: Name Type Description req.params.thingId string The _id of thing. req.body object Object containing new values for the thing. Returns: Type Thing × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"module-User%20Controller.html":{"id":"module-User%20Controller.html","title":"Module: User Controller","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Module: User Controller Controller for the user component Methods &lt;async, inner&gt; addPermission() Add a permission to an existing user Properties: Name Type Description req.params.userId string The id of user. req.body.permission String a string with the new permission for the user. Returns: Type User &lt;async, inner&gt; create() Create new user Properties: Name Type Description req.body.username string The username of user. req.body.password string The password of user. req.body.permissions Array.&lt;string&gt; Array of strings for the permissions Returns: Type User &lt;async, inner&gt; get() Get an existing user Properties: Name Type Description req.params.userId string The _id of user. Returns: Type User &lt;async, inner&gt; getPermissions() Get permissions for an existing user Properties: Name Type Description req.params.userId string The _id of user. Returns: Type User &lt;async, inner&gt; list() Get user list. Properties: Name Type Description req.query.skip number Number of users to be skipped. req.query.limit number Limit number of users to be returned. Returns: Type Array.&lt;User&gt; &lt;async, inner&gt; remove() Delete user. Properties: Name Type Description req.params.userId string The _id of user. Returns: Type User &lt;async, inner&gt; update() Update existing user Properties: Name Type Description req.params.userId string The _id of user. req.body object Object containing new values for the user. Returns: Type User × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"module-User%20Routes.html":{"id":"module-User%20Routes.html","title":"Module: User Routes","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Module: User Routes Routes for the /api/users endpoints Members &lt;route&gt; Create User Route: MethodPath POST /api/users Create a new user Authentication This route requires a token with Admin permission. If authentication fails it will return a 401 error. Body Parameters: Name Type Description User object is an object containing the required fields Response: Name Type Description User Object Return the newly created user. Response Code: Type Description 200 If the request is successful. 401 If authentication fails. &lt;route&gt; Get User Route: MethodPath POST /api/users/:userId Get a User Authentication This route requires a token with Admin permission. If authentication fails it will return a 401 error. Route Parameters: Name Type Description :userId String is the unique identifier for the user. Response: Name Type Description User Object Return the user. Error APIError Return an APIError if the user is not found. Response Code: Type Description 200 if the request is successful. 401 If authentication fails. 404 If user is not found. &lt;route&gt; Update User Route: MethodPath PUT /api/users/:userId Update a user Authentication This route requires a token with Admin permission. If authentication fails it will return a 401 error. Body Parameters: Name Type Description User object is an object containing the new user fields. Route Parameters: Name Type Description :userId String is the unique identifier for the user. &lt;route&gt; User List Route: MethodPath GET /api/users Get a list of users Authentication This route requires a token with Admin permission. If authentication fails it will return a 401 error. × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"ThingService.html":{"id":"ThingService.html","title":"Class: ThingService","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Class: ThingService ThingService Creates a new ThingService. new ThingService() Extends DbService Methods &lt;async&gt; Create(item) Create a new item Parameters: Name Type Description item Object representing a new item Inherited From: DbService#Create Returns: item - return the item or an Error with the error message Type object | Error &lt;async&gt; GetItem(itemId) Get a item Parameters: Name Type Description itemId The _id of the item Inherited From: DbService#GetItem Returns: item Type object | Error &lt;async&gt; List() Get a list of all items Inherited From: DbService#List Returns: item - An array of items Type Array.&lt;object&gt; &lt;async&gt; Remove(itemId) Update a item Parameters: Name Type Description itemId The _id of the item Inherited From: DbService#Remove Returns: 1 or error - \"Item not found.\" Type number | Error &lt;async&gt; Update(itemId, item) Update a item Parameters: Name Type Description itemId The _id of the item item TThe new values for the item Inherited From: DbService#Update Returns: item Type object | Error × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "},"UserService.html":{"id":"UserService.html","title":"Class: UserService","body":" Documentation Modules Auth ControllerAuth RoutesThing RoutesThingControllerUser ControllerUser Routes Classes APIErrorAuthServiceDbServiceExtendableErrorThingServiceUserService Class: UserService UserService Creates a new UserService. new UserService() Extends DbService Methods &lt;async&gt; AddUserPermission(userId, permission) Add a permissions to a user Parameters: Name Type Description userId the id of the user permission The name of the permission to add Returns: returns the new permission Type object | Error &lt;async&gt; Create(item) Create a new item Parameters: Name Type Description item Object representing a new item Inherited From: DbService#Create Returns: item - return the item or an Error with the error message Type object | Error &lt;async&gt; GetItem(itemId) Get a item Parameters: Name Type Description itemId The _id of the item Inherited From: DbService#GetItem Returns: item Type object | Error &lt;async&gt; GetUserPermissions(userId) Get the users permissions Parameters: Name Type Description userId the id of the user Returns: returns an array of strings representing the users permissions or an Error Type Array | Error &lt;async&gt; List() Get a list of all items Inherited From: DbService#List Returns: item - An array of items Type Array.&lt;object&gt; &lt;async&gt; Remove(itemId) Update a item Parameters: Name Type Description itemId The _id of the item Inherited From: DbService#Remove Returns: 1 or error - \"Item not found.\" Type number | Error &lt;async&gt; RemoveUserPermission(userId, permission) remove a permissions from a user Parameters: Name Type Description userId the id of the user permission The name of the permission to add Returns: returns 1 or error Type int | Error &lt;async&gt; Update(itemId, item) Update a item Parameters: Name Type Description itemId The _id of the item item TThe new values for the item Inherited From: DbService#Update Returns: item Type object | Error × Search results Close Documentation generated by JSDoc 3.6.3 on 2020-02-26T21:54:50-05:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
